<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SULF: SULF - Stackable User-Level Filesystem.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindexHL" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>SULF - Stackable User-Level Filesystem. </h1>
<p>
<h3 align="center">0.3 </h3><h3>Copyright &copy; 2004-2005 Valient Gough &lt;vgough@pobox.com&gt;</h3>
<p>
Distributed under the LGPL license, see COPYING for details.<h2><a class="anchor" name="introduction">
Introduction</a></h2>
SULF allows you to write a Linux filesystem in C#. It uses the FUSE library to do the actual Linux filesystem integration in user-space.<p>
By using FUSE, the C# code can run entirely in user-space and not require any special permissions to serve the filesystem.<p>
SULF is meant to be useful to filesystem <em>developers</em>. It currently contains only a simple test filesystem to use for testing.<h2><a class="anchor" name="Changes">
Recent Changes</a></h2>
2005.04.29 -- 0.3, Queen's Day release<ul>
<li>major API changes. API has become simpler and is split into two libraries. The Fuse.dll library communicates with the FUSE kernel module and provides an API based on simple C# interfaces (Node, FileNode, DirNode). The Sulf.dll library builds on Fuse.dll and provides a more natural interface to C# objects (a Hashmap can be used as a directory, string as a file, etc).</li><li>Updated FuseWrapper and <a class="el" href="namespaceFuse.html">Fuse</a> interfaces for FUSE 2.3 (Kernel api version 6.1)</li></ul>
<p>
2005.01.15<ul>
<li>updated FuseWrapper and <a class="el" href="namespaceFuse.html">Fuse</a> interfaces for FUSE 2.1 compatibility.</li><li>implemented simple Hello-World filesystem in examples subdirectory, which is similar to libfuse's example/hello.c</li></ul>
<p>
2005.01.13<ul>
<li>release under LGPL license</li><li>simplify build system to make it easier to build</li><li>add snapshot (see <a class="el" href="index.html#downloads">Downloads</a>)</li></ul>
<h2><a class="anchor" name="downloads">
Downloads</a></h2>
SULF is kept in revision control using Darcs (<a href="http://abridgegame.org/darcs/">http://abridgegame.org/darcs/</a>). The current development branch is available here: <a href="http://arg0.net/users/vgough/devel/sulf">http://arg0.net/users/vgough/devel/sulf</a><p>
An easier way to get started is to use the snapshot, which contains pre-built objects: <a href="http://arg0.net/users/vgough/download/sulf-0.3.tar.gz">sulf-0.3.tar.gz</a><p>
See also <a class="el" href="index.html#dependencies">Dependencies</a> , and <a class="el" href="index.html#getting-started">Getting Started</a><h2><a class="anchor" name="attempts">
Previous Attempts</a></h2>
<b>The old way</b><p>
My first attempt at building a C# wrapper for fuse was based on capturing all the callbacks from libfuse in C code, and then have a conversion layer translate that into calls to C# code (using internal Mono C# API). This worked, but had some downsides:<ul>
<li>required internal Mono API, so it couldn't be compiled or run with other C# compilers or runtimes.</li></ul>
<p>
<ul>
<li>could only run in single-threaded mode, since libfuse's threads created from C code would not play well with Mono's thread state.</li></ul>
<p>
<b>The new way</b><p>
The current method is significantly different. The C# code takes control immediately and talks directly to the FUSE kernel module with the help of a some C code (and wrappers generated automatically by SWIG).<p>
This no longer requires the use of Mono internal API's, and it also allows the filesystem to run multi-threaded. The downside is that the FUSE kernel interface has been more variable then the libfuse interface, which means that the C# interface will work with fewer versions of the FUSE code tree.<h2><a class="anchor" name="fuse-design">
Interface Design - Fuse.dll</a></h2>
Implementing a filesystem using Fuse.dll requires implementing three sets of interfaces. These interfaces correspond to the type of function calls that they will handle: filesystem level, directory level, and file level.<p>
1. <a class="el" href="classFuse_1_1FileSystem.html">Fuse.FileSystem</a> interface, which defines a Stat operation and a means of getting the top level directory.<p>
2. <a class="el" href="interfaceFuse_1_1DirNode.html">Fuse.DirNode</a> interface, which is used for access to directories (one of which is returned by the filesystem level -- FileSystem.RootNode):<p>
3. <a class="el" href="interfaceFuse_1_1FileNode.html">Fuse.FileNode</a> interface is used for access to normal files<p>
In addition to this three way split, the DirNode and FileNode interfaces also come in two flavors -- one for read-only objects, and another with write support. The Fuse.dll dispatch handler knows how to treat a file based on the interfaces it implements. For example, if a DirNode returns an object which implements FileNode (but not MutableFileNode), then the file will be read-only.<h2><a class="anchor" name="sulf-design">
Interface Design - Sulf.dll</a></h2>
The higher-level interface - Sulf.dll is meant to be a better / easier starting point for most filesystems, unless you need the full power of the underlying Fuse.dll interface.<p>
The Sulf.dll design is meant to translate from the Fuse.dll api into something more transparent to C# objects. This layer is newer and is in development.<p>
TODO: more to come. See examples and <a class="el" href="namespaceSulf.html">Sulf</a> directories.<h2><a class="anchor" name="dependencies">
Dependencies</a></h2>
<a class="el" href="namespaceSulf.html">Sulf</a> relies on these projects:<p>
FUSE 2.3 (Filesystem in User SpacE): <a href="http://sourceforge.net/projects/fuse">http://sourceforge.net/projects/fuse</a><p>
Mono (C# compiler and runtime): <a href="http://go-mono.org">http://go-mono.org</a><p>
SWIG (Simplified Wrapper and Interface Generator): <a href="http://www.swig.org/">http://www.swig.org/</a> <b>Must use SWIG &gt;= 1.3.24</b>. SWIG's C# output has been maturing recently, and SULF will not build with earlier versions of SWIG..<h2><a class="anchor" name="getting-started">
Getting Started</a></h2>
As long as you have the necessary dependencies statisfied, you can build the SULF libraries and a simple test filesystem by doing the following:<p>
<div class="fragment"><pre class="fragment">autoreconf      # build configure script

./configure
make

cd examples     

make run        # run hello-fs example which mounts to /tmp/hellofs
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Fri Apr 29 22:42:10 2005 for SULF by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
