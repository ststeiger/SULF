#!/usr/bin/perl -w

# This script generates the extra swig extensions for each fuse structure.
# fuse_*_in structs are extended to handle BufferReadable interface
# fuse_*_out structs are extended to handle BufferWritable interface..

use strict;

print "/* DO NOT EDIT -- Automatically generated by autotypemap */\n\n";

while(<>)
{
    # fuse_*_in structs are marked immutable, so only readers are constructed.
    if(m#struct fuse_(.*)_in\s#)
    {
	print <<EOF
%typemap(csinterfaces) struct fuse_$1_in "IDisposable, BufferReadable"
%extend fuse_$1_in {
    %immutable;
    int copyFrom( struct FWBuffer *buf ) { READSTRUCT( buf, fuse_$1_in ) }
};

EOF
    } elsif(m#struct fuse_(.*)_out\s#)
    {
	print <<EOF
%typemap(csinterfaces) struct fuse_$1_out "IDisposable, BufferWritable"
%extend fuse_$1_out {
    int copyTo( struct FWBuffer *buf ) { WRITESTRUCT( buf, fuse_$1_out ) }
};

EOF
    }
}

